\startenvironment reportlayout
%\enablemode[doublesided]
\environment documentlayout

\setupbodyfont[lucida,10pt]

\setuphead[chapter]
  [page=yes]

\setupformulas
  [align=right,
   margin=yes,
   spacebefore=big,
   spaceafter=big,
   indentnext=auto]

\usemodule[vim]
\setupvimtyping
  [style=\tt,
   numbering=no,
   numberstyle=\ttx,
   numberstep=5,
   margin=2em,
   before=\blank,
   after=\blank,
   indentnext=auto,
   directory=buffers,% DON'T FORGET TO CREATE THIS DIRECTORY!!!
   alternative=blackandwhite]
\definevimtyping[SPL]
  [syntax=spl]

\setupbibtex
  [database=literature]

\setupbodyfontenvironment[default]
  [em=italic]

\definefloat[rule][rules]
\setupfloat[rule]
  [location=left,
   default=force,
   leftmargin=2em,
   indentnext=auto]
\setupcaption[rule]
  [location=right,
   number=no,
   style=\ss]

\let\leadsto\implies
\define\SPL  {{\sc spl}}
\define\SSM  {{\sc ssm}}
\define\Stm  {{\math{\mathcal{S}}}}
\define\Exp  {{\math{\mathcal{E}}}}
\define\Def  {{\math{\mathcal{D}}}}
\define\Op   {{\math{\mathcal{O}}}}
\define\Stms {{\math{\mathcal{S}^+}}}
\define\Exps {{\math{\mathcal{E}^+}}}

\definemathcommand[bigbowtie][limop]{\bowtie\:}

\define[1]\definelabel
  {\setvalue{#1}{\text{\ss\tf #1}}}
\definelabel{Int}
\definelabel{Bool}
\definelabel{Void}
\definelabel{PC}
\definelabel{SP}
\definelabel{MP}
\definelabel{RR}
\definelabel{GP}
\definelabel{ifLabel}
\definelabel{thenLabel}
\definelabel{elseLabel}
\definelabel{fiLabel}
\definelabel{whileLabel}
\definelabel{doLabel}
\definelabel{odLabel}

\define[2]\definekeyword
  {\setvalue{#1}{\text{\tt\bf #2}}}
\definekeyword{Return}{return}
\definekeyword{If}{if}
\definekeyword{Else}{else}
\definekeyword{While}{while}
\definekeyword{Match}{match}
\definekeyword{Case}{case}
\definekeyword{True}{True}
\definekeyword{False}{False}
\definekeyword{VOID}{Void}
\definekeyword{INT}{Int}
\definekeyword{BOOL}{Bool}
\definekeyword{Print}{print}
\definekeyword{IsEmpty}{isEmpty}
\definekeyword{Head}{head}
\definekeyword{Tail}{tail}
\definekeyword{Fst}{fst}
\definekeyword{Snd}{snd}
\definekeyword{Main}{main}
\definekeyword{Globals}{_globals}

\define[2]\defineoperator
  {\setvalue{#1}{\text{\tt\tf #2}}}
\defineoperator{Add}{+}
\defineoperator{Sub}{-}
\defineoperator{Mul}{*}
\defineoperator{Div}{/}
\defineoperator{Mod}{\%}
\defineoperator{Eq}{==}
\defineoperator{Ne}{!=}
\defineoperator{Lt}{<}
\defineoperator{Gt}{>}
\defineoperator{Le}{<=}
\defineoperator{Ge}{>=}
\defineoperator{And}{&&}
\defineoperator{Or}{||}
\defineoperator{Cons}{:}
\defineoperator{Not}{!}
\defineoperator{Neg}{-}

\define[1]\defineinstruction
  {\setvalue{#1}{\text{\tt\tf #1}}}
\defineinstruction{ADD}
\defineinstruction{SUB}
\defineinstruction{MUL}
\defineinstruction{DIV}
\defineinstruction{MOD}
\defineinstruction{NEG}
\defineinstruction{AND}
\defineinstruction{OR}
\defineinstruction{XOR}
\defineinstruction{NOT}
\defineinstruction{EQ}
\defineinstruction{NE}
\defineinstruction{GT}
\defineinstruction{LT}
\defineinstruction{GE}
\defineinstruction{LE}
\defineinstruction{LDC}
\defineinstruction{LDS}
\defineinstruction{LDL}
\defineinstruction{LDA}
\defineinstruction{LDR}
\defineinstruction{LDH}
\defineinstruction{STS}
\defineinstruction{STL}
\defineinstruction{STA}
\defineinstruction{STR}
\defineinstruction{STH}
\defineinstruction{LDMS}
\defineinstruction{LDML}
\defineinstruction{LDMA}
\defineinstruction{LDMH}
\defineinstruction{STMS}
\defineinstruction{STML}
\defineinstruction{STMA}
\defineinstruction{STMH}
\defineinstruction{BRA}
\defineinstruction{BRT}
\defineinstruction{BRF}
\defineinstruction{AJS}
\defineinstruction{NOP}
\defineinstruction{HALT}
\defineinstruction{TRAP}
\defineinstruction{JSR}
\defineinstruction{BSR}
\defineinstruction{RET}
\defineinstruction{ANNOTE}
\defineinstruction{LDAA}
\defineinstruction{LDRR}
\defineinstruction{LDLA}
\defineinstruction{LDSA}
\defineinstruction{LINK}
\defineinstruction{UNLINK}
\defineinstruction{SWP}
\defineinstruction{SWPR}
\defineinstruction{SWPRR}

\definetabulate[grammar][|lI|cM|lI|]
\define\TQ{\NC \to \NC}
\define\OQ{\NR\NC\NC \mid \NC}

\makecharacteractive @ %@
\def@#1@{{\tt\tf #1}}

\def\startderivationformula#1\NL#2\stopderivationformula
  {\starttabulate[|cM|]
   \NC #1 \NR
   \HL
   \NC #2 \NR
   \stoptabulate}
\def\startextendedderivationformula#1\NL#2\LR#3\stopextendedderivationformula
  {\starttabulate[|cM|]
   \NC #1 \NR
   \HL
   \NC #2 \NR
   \NC #3 \NR
   \stoptabulate}
%\starttexdefinition startderivationformula
%  \start
%    \define\NL{\NR\HL\NC}
%    \starttabulate[|cM|]
%      \NC
%\stoptexdefinition
%\starttexdefinition stopderivationformula
%      \NR
%    \stoptabulate
%  \stop
%\stoptexdefinition
%\define\startderivationformula
  %{\starttabulate[|cM|] \NC}
%\define\stopderivationformula
  %{\NR \stoptabulate}
%\define\NL
  %{\NR\HL\NC}

\stopenvironment

% vim: ft=context
